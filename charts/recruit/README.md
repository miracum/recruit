# recruIT

[recruIT](https://miracum.github.io/recruit) - Helm chart for deploying the recruIT clinical trial recruitment support system on Kubernetes.

## TL;DR;

```console
helm repo add miracum https://miracum.github.io/charts
helm repo update
helm install recruit miracum/recruit -n recruit
```

You can find more exhaustive documentation at the recruIT documentation site: <https://miracum.github.io/recruit/deployment/kubernetes>.

## Introduction

This chart deploys the recruIT clinical trial recruitment support system on a [Kubernetes](http://kubernetes.io) cluster using the [Helm](https://helm.sh) package manager.

## Prerequisites

- Kubernetes v1.21+
- Helm v3.8+

## Upgrades & Breaking Changes

See [UPGRADING.md](./docs/UPGRADING.md) for information on breaking changes introduced by major version bumps and instructions on how to update.

## Installing the Chart

To install the chart with the release name `recruit`:

```console
helm install recruit miracum/recruit -n recruit
```

The command deploys the recruIT clinical trial recruitment support system on the Kubernetes cluster in the default configuration. The [configuration](#configuration) section lists the parameters that can be configured during installation.

> **Tip**: List all releases using `helm list`

## Uninstalling the Chart

To uninstall/delete the `recruit`:

```console
helm delete recruit -n recruit
```

The command removes all the Kubernetes components associated with the chart and deletes the release.

## Configuration

The following table lists the configurable parameters of the `recruit` chart and their default values.

| Parameter                                            | Description                                                                                                                                                                                                                                                                                                                                                          | Default                                                                                                                                                          |
| ---------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| imagePullSecrets                                     |                                                                                                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                  |
| nameOverride                                         | partially override the release name                                                                                                                                                                                                                                                                                                                                  | <code>""</code>                                                                                                                                                  |
| fullnameOverride                                     | fully override the release name                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| deploymentAnnotations                                | Annotations to set on all Deployment resources                                                                                                                                                                                                                                                                                                                       | <code>{}</code>                                                                                                                                                  |
| podAnnotations                                       | Annotations to set on all Pod resources                                                                                                                                                                                                                                                                                                                              | <code>{}</code>                                                                                                                                                  |
| extraLabels                                          | additionally labels to apply to all deployments                                                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                  |
| fhirserver.enabled                                   | See <https://github.com/hapifhir/hapi-fhir-jpaserver-starter/tree/master/charts/hapi-fhir-jpaserver#values> for options.                                                                                                                                                                                                                                             | <code>true</code>                                                                                                                                                |
| fhirserver.postgresql.nameOverride                   |                                                                                                                                                                                                                                                                                                                                                                      | <code>"fhir-server-postgres"</code>                                                                                                                              |
| fhirserver.networkPolicy.enabled                     | all pods of the recruIT chart will be automatically configured to be able to access the server.                                                                                                                                                                                                                                                                      | <code>false</code>                                                                                                                                               |
| externalFhirServer.url                               |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| mailhog.enabled                                      | See <https://github.com/codecentric/helm-charts/blob/master/charts/mailhog/values.yaml> for available options.                                                                                                                                                                                                                                                       | <code>true</code>                                                                                                                                                |
| mailhog.containerSecurityContext.runAsNonRoot        |                                                                                                                                                                                                                                                                                                                                                                      | <code>true</code>                                                                                                                                                |
| mailhog.containerSecurityContext.seccompProfile.type |                                                                                                                                                                                                                                                                                                                                                                      | <code>RuntimeDefault</code>                                                                                                                                      |
| ohdsi.enabled                                        | See <https://github.com/chgl/charts/tree/master/charts/ohdsi/values.yaml> for available options.                                                                                                                                                                                                                                                                     | <code>true</code>                                                                                                                                                |
| ohdsi.postgresql.nameOverride                        |                                                                                                                                                                                                                                                                                                                                                                      | <code>"ohdsi-postgres"</code>                                                                                                                                    |
| ohdsi.cdmInitJob.enabled                             |                                                                                                                                                                                                                                                                                                                                                                      | <code>false</code>                                                                                                                                               |
| query.enabled                                        |                                                                                                                                                                                                                                                                                                                                                                      | <code>true&#13;&#10;# Number of replicas of the query module to run.</code>                                                                                      |
| query.replicaCount                                   | Running more than one replica for this component is discouraged.                                                                                                                                                                                                                                                                                                     | <code>1</code>                                                                                                                                                   |
| query.revisionHistoryLimit                           |                                                                                                                                                                                                                                                                                                                                                                      | <code>5</code>                                                                                                                                                   |
| query.metrics.serviceMonitor.enabled                 |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# additional labels to apply the the ServiceMonitor object, eg. `release: prometheus`</code>                                                |
| query.metrics.serviceMonitor.additionalLabels        |                                                                                                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                  |
| query.extraEnv                                       | extra environment vars on the container                                                                                                                                                                                                                                                                                                                              | <code>[]</code>                                                                                                                                                  |
| query.extraPodLabels                                 | specify additional labels to apply to the query pod                                                                                                                                                                                                                                                                                                                  | <code>{}</code>                                                                                                                                                  |
| query.service.type                                   |                                                                                                                                                                                                                                                                                                                                                                      | <code>ClusterIP&#13;&#10;# the service port for the HTTP endpoint</code>                                                                                         |
| query.service.port                                   |                                                                                                                                                                                                                                                                                                                                                                      | <code>8080</code>                                                                                                                                                |
| query.service.metricsPort                            |                                                                                                                                                                                                                                                                                                                                                                      | <code>8081</code>                                                                                                                                                |
| query.webAPI.url                                     |                                                                                                                                                                                                                                                                                                                                                                      | <code>"http://example:8080/WebAPI"&#13;&#10;# name of the OMOP datasource used to generate the cohorts from.</code>                                              |
| query.webAPI.dataSource                              |                                                                                                                                                                                                                                                                                                                                                                      | <code>"CDS-CDMV5"</code>                                                                                                                                         |
| query.webAPI.auth.enabled                            |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# the login method/path to use. See <https://github.com/OHDSI/Atlas/blob/master/js/config/app.js#L20> for a list of possible values</code>  |
| query.webAPI.auth.loginPath                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>"/user/login/db"</code>                                                                                                                                    |
| query.webAPI.auth.username                           |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| query.webAPI.auth.password                           |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| query.webAPI.auth.existingSecret.name                |                                                                                                                                                                                                                                                                                                                                                                      | <code>""&#13;&#10;# the key containing the password</code>                                                                                                       |
| query.webAPI.auth.existingSecret.key                 |                                                                                                                                                                                                                                                                                                                                                                      | <code>"webApiAuthPassword"</code>                                                                                                                                |
| query.schedule                                       | A UNIX cron expression defining the execution schedule of the query module                                                                                                                                                                                                                                                                                           | <code>"_/5 _ \* \* \*"</code>                                                                                                                                    |
| query.omop.host                                      |                                                                                                                                                                                                                                                                                                                                                                      | <code>"localhost"&#13;&#10;# port of the db</code>                                                                                                               |
| query.omop.port                                      |                                                                                                                                                                                                                                                                                                                                                                      | <code>5432</code>                                                                                                                                                |
| query.omop.database                                  |                                                                                                                                                                                                                                                                                                                                                                      | <code>OHDSI</code>                                                                                                                                               |
| query.omop.username                                  |                                                                                                                                                                                                                                                                                                                                                                      | <code>postgres</code>                                                                                                                                            |
| query.omop.password                                  |                                                                                                                                                                                                                                                                                                                                                                      | <code>postgres</code>                                                                                                                                            |
| query.omop.existingSecret                            |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| query.omop.resultsSchema                             |                                                                                                                                                                                                                                                                                                                                                                      | <code>cds_results</code>                                                                                                                                         |
| query.omop.cdmSchema                                 |                                                                                                                                                                                                                                                                                                                                                                      | <code>cds_cdm</code>                                                                                                                                             |
| query.shouldWaitForNotify                            | whether the query module should wait for the notification module to be up before starting. implemented as an init container that waits on notify's `/actuator/health` endpoint                                                                                                                                                                                       | <code>false</code>                                                                                                                                               |
| query.resources                                      | resource requests and limits for the container                                                                                                                                                                                                                                                                                                                       | <code>{}</code>                                                                                                                                                  |
| query.nodeSelector                                   | node labels for pod assignment see: <https://kubernetes.io/docs/user-guide/node-selection/>                                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                  |
| query.tolerations                                    | tolerations for pod assignment see: <https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/>                                                                                                                                                                                                                                                        | <code>[]</code>                                                                                                                                                  |
| query.affinity                                       | affinity for pod assignment see: <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity>                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                  |
| query.podSecurityContext                             | security context for the pod                                                                                                                                                                                                                                                                                                                                         | <code>{}</code>                                                                                                                                                  |
| query.topologySpreadConstraints                      | pod topology spread configuration see: <https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/#api>                                                                                                                                                                                                                                     | <code>[]</code>                                                                                                                                                  |
| notify.enabled                                       |                                                                                                                                                                                                                                                                                                                                                                      | <code>true&#13;&#10;# number of replicas for the notify component.</code>                                                                                        |
| notify.replicaCount                                  | should only be set to a number > 1 if `notify.ha.enabled=true`                                                                                                                                                                                                                                                                                                       | <code>1</code>                                                                                                                                                   |
| notify.revisionHistoryLimit                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>5</code>                                                                                                                                                   |
| notify.metrics.serviceMonitor.enabled                |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# additional labels to set on the ServiceMonitor object, e.g. `release: prometheus-operator`</code>                                         |
| notify.metrics.serviceMonitor.additionalLabels       |                                                                                                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                  |
| notify.extraEnv                                      | extra environment vars on the container                                                                                                                                                                                                                                                                                                                              | <code>[]</code>                                                                                                                                                  |
| notify.extraPodLabels                                | specify additional labels to apply to the notify pod                                                                                                                                                                                                                                                                                                                 | <code>{}</code>                                                                                                                                                  |
| notify.mail.server.host                              |                                                                                                                                                                                                                                                                                                                                                                      | <code>""&#13;&#10;# Mailserver port</code>                                                                                                                       |
| notify.mail.server.port                              |                                                                                                                                                                                                                                                                                                                                                                      | <code>25</code>                                                                                                                                                  |
| notify.mail.server.username                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.mail.server.password                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.mail.server.existingSecret                    |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.mail.screeningListLinkTemplate                | If the screening list ingress is enabled, it uses list.ingress.hosts.host to construct the URL, otherwise uses this value. Should include a '[list_id]' which is replaced with the internal screening list id.                                                                                                                                                       | <code>"http://localhost:8080/recommendations/[list_id]"</code>                                                                                                   |
| notify.mail.from                                     |                                                                                                                                                                                                                                                                                                                                                                      | <code>"recruit@example.com"</code>                                                                                                                               |
| notify.ha.enabled                                    |                                                                                                                                                                                                                                                                                                                                                                      | <code>false</code>                                                                                                                                               |
| notify.ha.database.host                              | if `postgresql.enabled=true`, uses the included PostgreSQL database instead.                                                                                                                                                                                                                                                                                         | <code>""&#13;&#10;# database port</code>                                                                                                                         |
| notify.ha.database.port                              |                                                                                                                                                                                                                                                                                                                                                                      | <code>5432</code>                                                                                                                                                |
| notify.ha.database.username                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.ha.database.password                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.ha.database.name                              |                                                                                                                                                                                                                                                                                                                                                                      | <code>"recruit_notify_jobstore"</code>                                                                                                                           |
| notify.ha.database.existingSecret.name               |                                                                                                                                                                                                                                                                                                                                                                      | <code>""&#13;&#10;# key inside the existing secret</code>                                                                                                        |
| notify.ha.database.existingSecret.key                |                                                                                                                                                                                                                                                                                                                                                                      | <code>"postgresql-password"</code>                                                                                                                               |
| notify.podDisruptionBudget.enabled                   |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# Minimum available instances; ignored if there is no PodDisruptionBudget</code>                                                            |
| notify.podDisruptionBudget.minAvailable              |                                                                                                                                                                                                                                                                                                                                                                      | <code>1</code>                                                                                                                                                   |
| notify.podDisruptionBudget.maxUnavailable            |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.rules                                         | Configure the Notification rules. See the [Configure Notifcation Rules](#configure-notifcation-rules) section below.                                                                                                                                                                                                                                                 | <code>{}</code>                                                                                                                                                  |
| notify.service.type                                  |                                                                                                                                                                                                                                                                                                                                                                      | <code>ClusterIP&#13;&#10;# service port for the HTTP endpoint</code>                                                                                             |
| notify.service.port                                  |                                                                                                                                                                                                                                                                                                                                                                      | <code>8080</code>                                                                                                                                                |
| notify.service.metricsPort                           |                                                                                                                                                                                                                                                                                                                                                                      | <code>8081</code>                                                                                                                                                |
| notify.ingress.enabled                               | Setting this ingress is useful if the FHIR server is external to the cluster and can only be reached via this ingress. The URL called by the external FHIR server with ingress enabled is as follows: "http(s)://ingress.hosts[0].host/on-list-change" If ingress.enabled is false, then the notify.service is used to construct the URL invoked by the FHIR server. | <code>false&#13;&#10;# name of the IngressClass resource to use for this ingress</code>                                                                          |
| notify.ingress.ingressClassName                      |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| notify.ingress.annotations                           |                                                                                                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                  |
| notify.ingress.tls                                   |                                                                                                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                  |
| notify.resources                                     | resource requests and limits for the container                                                                                                                                                                                                                                                                                                                       | <code>{}</code>                                                                                                                                                  |
| notify.nodeSelector                                  | node labels for pod assignment see: <https://kubernetes.io/docs/user-guide/node-selection/>                                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                  |
| notify.tolerations                                   | tolerations for pod assignment see: <https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/>                                                                                                                                                                                                                                                        | <code>[]</code>                                                                                                                                                  |
| notify.affinity                                      | affinity for pod assignment see: <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity>                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                  |
| notify.topologySpreadConstraints                     | pod topology spread configuration see: https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/#api                                                                                                                                                                                                                                       | <code>[]</code>                                                                                                                                                  |
| notify.podSecurityContext                            | topologyKey: topology.kubernetes.io/zone whenUnsatisfiable: ScheduleAnyway labelSelector: matchLabels: app.kubernetes.io/component: notify app.kubernetes.io/instance: recruit security context for the pod                                                                                                                                                          | <code>{}</code>                                                                                                                                                  |
| list.enabled                                         |                                                                                                                                                                                                                                                                                                                                                                      | <code>true&#13;&#10;# Number of replicas for the list module. A fault-tolerant number of replicas is recommended.</code>                                         |
| list.replicaCount                                    |                                                                                                                                                                                                                                                                                                                                                                      | <code>1</code>                                                                                                                                                   |
| list.revisionHistoryLimit                            |                                                                                                                                                                                                                                                                                                                                                                      | <code>5</code>                                                                                                                                                   |
| list.service.type                                    |                                                                                                                                                                                                                                                                                                                                                                      | <code>ClusterIP&#13;&#10;# service port</code>                                                                                                                   |
| list.service.port                                    |                                                                                                                                                                                                                                                                                                                                                                      | <code>8080</code>                                                                                                                                                |
| list.auth.enabled                                    |                                                                                                                                                                                                                                                                                                                                                                      | <code>false</code>                                                                                                                                               |
| list.auth.keycloak.clientId                          |                                                                                                                                                                                                                                                                                                                                                                      | <code>"uc1-screeninglist"&#13;&#10;# the Keycloak realm</code>                                                                                                   |
| list.auth.keycloak.realm                             |                                                                                                                                                                                                                                                                                                                                                                      | <code>"MIRACUM"</code>                                                                                                                                           |
| list.auth.keycloak.url                               |                                                                                                                                                                                                                                                                                                                                                                      | <code>"http://localhost:8083/auth"</code>                                                                                                                        |
| list.dePseudonymization.enabled                      |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# API base URL of the FHIR pseudonymizer to use. If `fhir-pseudonymizer.enabled` is set to `true`, this URL will be auto-configured.</code> |
| list.dePseudonymization.serviceUrl                   |                                                                                                                                                                                                                                                                                                                                                                      | <code>"http://fhir-pseudonymizer:8080/fhir"</code>                                                                                                               |
| list.dePseudonymization.apiKey                       |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| list.dePseudonymization.existingApiKeySecret.name    | Leave empty to use `dePseudonymization.apiKey` instead.                                                                                                                                                                                                                                                                                                              | <code>""&#13;&#10;# key of the Kubernetes Secret that contains the API key</code>                                                                                |
| list.dePseudonymization.existingApiKeySecret.key     |                                                                                                                                                                                                                                                                                                                                                                      | <code>"fhir-pseudonymizer-api-key"</code>                                                                                                                        |
| list.metrics.serviceMonitor.enabled                  |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# additional labels</code>                                                                                                                  |
| list.metrics.serviceMonitor.additionalLabels         |                                                                                                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                  |
| list.extraEnv                                        | specify extra environment vars on the container                                                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                  |
| list.extraPodLabels                                  | specify additional labels to apply to the list pod                                                                                                                                                                                                                                                                                                                   | <code>{}</code>                                                                                                                                                  |
| list.ingress.enabled                                 |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# name of the IngressClass resource to use for this ingress</code>                                                                          |
| list.ingress.ingressClassName                        |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| list.ingress.annotations                             |                                                                                                                                                                                                                                                                                                                                                                      | <code>{}</code>                                                                                                                                                  |
| list.ingress.tls                                     |                                                                                                                                                                                                                                                                                                                                                                      | <code>[]</code>                                                                                                                                                  |
| list.podDisruptionBudget.enabled                     |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# Minimum available instances; ignored if there is no PodDisruptionBudget</code>                                                            |
| list.podDisruptionBudget.minAvailable                |                                                                                                                                                                                                                                                                                                                                                                      | <code>1</code>                                                                                                                                                   |
| list.podDisruptionBudget.maxUnavailable              |                                                                                                                                                                                                                                                                                                                                                                      | <code>""</code>                                                                                                                                                  |
| list.resources                                       | resource requests and limits for the container                                                                                                                                                                                                                                                                                                                       | <code>{}</code>                                                                                                                                                  |
| list.nodeSelector                                    | node labels for pod assignment see: <https://kubernetes.io/docs/user-guide/node-selection/>                                                                                                                                                                                                                                                                          | <code>{}</code>                                                                                                                                                  |
| list.tolerations                                     | tolerations for pod assignment see: <https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/>                                                                                                                                                                                                                                                        | <code>[]</code>                                                                                                                                                  |
| list.affinity                                        | affinity for pod assignment see: <https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity>                                                                                                                                                                                                                                     | <code>{}</code>                                                                                                                                                  |
| list.podSecurityContext                              | security context for the pod                                                                                                                                                                                                                                                                                                                                         | <code>{}</code>                                                                                                                                                  |
| list.topologySpreadConstraints                       | pod topology spread configuration see: https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/#api                                                                                                                                                                                                                                       | <code>[]</code>                                                                                                                                                  |
| postgresql.enabled                                   | to store jobs when running in high-availability mode (`notify.ha.enabled=true`)                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# override the default name to avoid conflicts with the HAPI and OHDSI charts</code>                                                        |
| postgresql.nameOverride                              |                                                                                                                                                                                                                                                                                                                                                                      | <code>"recruit-postgres"</code>                                                                                                                                  |
| postgresql.auth.database                             |                                                                                                                                                                                                                                                                                                                                                                      | <code>"recruit"</code>                                                                                                                                           |
| fhir-pseudonymizer.enabled                           |                                                                                                                                                                                                                                                                                                                                                                      | <code>false&#13;&#10;# default to using Vfps as a pseudonym service. It is included as a dependency of the fhir-pseudonymizer.</code>                            |
| fhir-pseudonymizer.pseudonymizationService           |                                                                                                                                                                                                                                                                                                                                                                      | <code>Vfps</code>                                                                                                                                                |
| fhir-pseudonymizer.vfps.enabled                      |                                                                                                                                                                                                                                                                                                                                                                      | <code>true</code>                                                                                                                                                |
| broadseaAtlasdb.enabled                              | currently only used by internal integration tests. See [./values-integrationtest.yaml](values-integrationtest.yaml)                                                                                                                                                                                                                                                  | <code>false</code>                                                                                                                                               |

Specify each parameter using the `--set key=value[,key=value]` argument to `helm install`. For example:

```console
helm install recruit miracum/recruit -n recruit --set fhirserver.postgresql.nameOverride="fhir-server-postgres"
```

Alternatively, a YAML file that specifies the values for the parameters can be provided while
installing the chart. For example:

```console
helm install recruit miracum/recruit -n recruit --values values.yaml
```

## Configure Notifcation Rules

The notification rules can be directly configured inside your values.yaml. For example:

```yaml
notify:
  enabled: true
  rules:
    # create custom notification schedules using https://www.cronmaker.com
    # these are later referenced used when configuring the notification frequency per user.
    # Note that the user will only receive an email notification if the scheduled time has been
    # reached _and_ there has been a _new_ patient recommendation since the last one.An identical
    # email won't be relentlessly sent everyMorning/Monday/Hour etc...
    schedules:
      everyMorning: "0 0 8 1/1 * ? *"
      everyMonday: "0 0 8 ? * MON *"
      everyHour: "0 0 0/1 1/1 * ? *"
      everyFiveMinutes: "0 0/5 * 1/1 * ? *"

    # trials are identified by their acronym which corresponds to the cohort's title in Atlas or the "[acronym=XYZ]" tag
    trials:
      # a value of '*' matches every trial, so 'everything@example.com' will receive an email whenever any screeninglist
      # gets updated.
      - acronym: "*"
        subscriptions:
          - email: "everything@example.com"

      - acronym: "SAMPLE"
        # the new "accessibleBy" key allows specifying users either by username or email address that
        # are allowed to access the screening list
        accessibleBy:
          users:
            - "user1"
            - "user.two@example.com"
        subscriptions:
          - email: "everyMorning@example.com"
            # each 'notify'-value corresponds to one schedule
            notify: "everyMorning"
            # a lack of a 'notify'-key with an associated schedule means that the user will be notified immediately.
          - email: "immediately-sample@example.com"
            # For example, the following entry means that if the 'SAMPLE' trial received new screening recommendations,
            # an email is sent to 'everyMonday@example.com' on the next monday. This is useful for aggregating notifications
            # about screening recommendations.
          - email: "everyMonday@example.com"
            notify: "everyMonday"

      - acronym: "AMICA"
        subscriptions:
          - email: "immediately-amica@example.com"
          - email: "everyHour1@example.com"
            notify: "everyHour"
          - email: "everyHour2@example.com"
            notify: "everyHour"
          - email: "everyFiveMinutes@example.com"
            notify: "everyFiveMinutes"
```

## Distributed Tracing

See the documentation on distributed tracing for more information: <https://miracum.github.io/recruit/deployment/kubernetes/#distributed-tracing>.
